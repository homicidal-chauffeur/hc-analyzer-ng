<div class="btn-group mt-3 mb-2">
  <button class="btn btn-success" [hidden]="!paused"
          (click)="start()">
    Start Simulation
  </button>
  <button class="btn btn-warning" [hidden]="paused"
          (click)="pause()">
    Pause Simulation
  </button>
  <button class="btn btn-danger"
          (click)="resetSimulation()">
    Reset Simulation
  </button>
</div>

<div class="form-group">
  <label>Animation Speed:</label>
  <mat-slider thumbLabel="true" tickInterval="auto" max="100"
              class="col-4"
              step="1" [(value)]="delay"></mat-slider>
</div>


<div class="form-group" [formGroup]="form">
  <label class="mr-2">Progress:</label>
  <mat-slider thumbLabel="true" tickInterval="auto" [max]="steps" step="1"
              (input)="move()"
              formControlName="slider"
              class="col-8"></mat-slider>
</div>

<svg xmlns="http://www.w3.org/2000/svg" [attr.viewBox]="viewBox"
     [attr.width]="svgWidth" [attr.height]="svgHeight" version="1.1" id="canvas" class="canvas">
  <rect height="100%" width="100%"  fill="gray" fill-opacity="0.1"></rect>
  <text x="5" y="50" font-family="sans-serif" font-size="20px" fill="black">Time: {{ time / 1000 }}s</text>
  <text x="5" y="75" font-family="sans-serif" font-size="20px" fill="blue">
    Evader: Pos {{ round(lastMoves['Evader']?.my_position.x) }}x{{ round(lastMoves['Evader']?.my_position.y) }},
    θ={{ round(lastMoves['Evader']?.my_theta) }}
  </text>
  <text x="5" y="100" font-family="sans-serif" font-size="20px" fill="red">
    Pursuer: Pos {{ round(lastMoves['Pursuer']?.my_position.x) }}x{{ round(lastMoves['Pursuer']?.my_position.y) }},
    θ={{ round(lastMoves['Pursuer']?.my_theta) }}
  </text>
  <text x="5" y="125" font-family="sans-serif" font-size="20px" [attr.fill]="distance < captureDistance ? 'orange' : 'green'">
    Distance: {{ round(distance) }}
  </text>

  <g [attr.transform]="trajTransformation">
    <path transform="translate(-12, -12)" fill="green" d="M12,4.64516129 C7.93451613,4.64516129 4.64516129,7.93548387 4.64516129,12 C4.64516129,16.0654839 7.93548387,19.3548387 12,19.3548387 C16.0654839,19.3548387 19.3548387,16.0645161 19.3548387,12 C19.3548387,7.93451613 16.0645161,4.64516129 12,4.64516129 Z M12,17.0322581 C9.225,17.0322581 6.96774194,14.775 6.96774194,12 C6.96774194,9.225 9.225,6.96774194 12,6.96774194 C14.775,6.96774194 17.0322581,9.225 17.0322581,12 C17.0322581,14.775 14.775,17.0322581 12,17.0322581 Z M12,0 C5.37241935,0 0,5.37241935 0,12 C0,18.6275806 5.37241935,24 12,24 C18.6275806,24 24,18.6275806 24,12 C24,5.37241935 18.6275806,0 12,0 Z M12,21.6774194 C6.66387097,21.6774194 2.32258065,17.336129 2.32258065,12 C2.32258065,6.66387097 6.66387097,2.32258065 12,2.32258065 C17.336129,2.32258065 21.6774194,6.66387097 21.6774194,12 C21.6774194,17.336129 17.336129,21.6774194 12,21.6774194 Z M12,9.29032258 C10.5058065,9.29032258 9.29032258,10.5058065 9.29032258,12 C9.29032258,13.4941935 10.5058065,14.7096774 12,14.7096774 C13.4941935,14.7096774 14.7096774,13.4941935 14.7096774,12 C14.7096774,10.5058065 13.4941935,9.29032258 12,9.29032258 Z"></path>
    <path id="evader" [attr.transform]="pilotTransformations['Evader']" fill="blue" d="M19.0729167,7.35679167 L14.8507083,7.35679167 L13.7358333,5.33333333 L14.1666667,5.33333333 C14.4427917,5.33333333 14.6666667,5.10945833 14.6666667,4.83333333 L14.6666667,3.16666667 C14.6666667,2.89054167 14.4427917,2.66666667 14.1666667,2.66666667 L12.2665833,2.66666667 L11.2012083,0.733083333 L11.177,0.6915 C10.9144583,0.264958333 10.44025,0 9.93945833,0 L7.75741667,0 C6.82108333,0 6.13445833,0.869416667 6.340125,1.77408333 L7.385375,7.42983333 C6.86339982,7.46651617 6.34264933,7.51892887 5.82383333,7.587 L4.674625,5.820875 C4.41104167,5.39745833 3.94045833,5.13541667 3.440875,5.13541667 L1.8335,5.13541667 C0.915625,5.13541667 0.228958333,5.97520833 0.408583333,6.8735 L0.906958333,9.365375 C0.325875,9.75954167 0,10.20075 0,10.6667083 C0,11.1326667 0.325875,11.573875 0.906916667,11.968 L0.408583333,14.4597917 C0.228625,15.3598333 0.917416667,16.1980417 1.83354167,16.197875 L3.441125,16.1978333 C3.940625,16.1977083 4.41104167,15.9356667 4.674625,15.5124167 L5.82379167,13.7463333 C6.34260576,13.8144209 6.86335674,13.8668337 7.38533333,13.9035 L6.340125,19.5591667 C6.13425,20.4649583 6.822125,21.3333333 7.75741667,21.3333333 L9.93945833,21.3333333 C10.4403333,21.3333333 10.9145,21.0683333 11.1770417,20.64175 L11.189625,20.6212917 L12.2665417,18.6666667 L14.1666667,18.6666667 C14.4427917,18.6666667 14.6666667,18.4427917 14.6666667,18.1666667 L14.6666667,16.5 C14.6666667,16.223875 14.4427917,16 14.1666667,16 L13.7357917,16 L14.8507083,13.9764583 L19.0729167,13.9765 C21.2839167,13.9765 24,12.7855833 24,10.6666667 C24,8.547 21.2826667,7.35679167 19.0729167,7.35679167 Z M19.0729167,11.9765 L13.6691667,11.9764583 L9.61575,19.3333333 L8.41570833,19.3333333 L9.771625,11.996375 C7.54433333,11.9299583 7.16466667,11.9350833 4.846875,11.580625 L3.143875,14.1977917 L2.50058333,14.1978333 L3.20683333,10.6666667 L2.50058333,7.135375 L3.14391667,7.135375 L4.84691667,9.752625 C7.16654167,9.39783333 7.54825,9.40320833 9.77166667,9.33683333 L8.41579167,2 L9.61579167,2 L13.6691667,9.35679167 L19.0729167,9.35679167 C20.6843333,9.35679167 22,10 22,10.6666667 C22,11.3333333 20.6841667,11.9765 19.0729167,11.9765 Z" ></path>

    <g [attr.transform]="pilotTransformations['Pursuer']">
      <circle cx="12" cy="12" [attr.r]="captureDistance / 2 * scale" [attr.fill]="distance < captureDistance ? 'red' : 'orange'" fill-opacity="0.1"></circle>
      <path id="pursuer"  fill="red" d="M19.4695788,5.59375975 L15.425897,5.13173167 L13.8615913,4.49297972 L13.4441186,4.49297972 L10.8018721,1.19026521 C11.6341966,1.14421217 12.2808112,0.901965679 12.2808112,0.599063963 C12.2808112,0.262090484 11.480312,0 10.513947,0 L4.7925117,0 L4.7925117,1.19812793 L5.39157566,1.19812793 L5.39157566,3.57678627 L4.47351014,2.39625585 L1.69160686,2.39625585 L0.299531981,3.78833073 L0.299531981,6.11419657 L0,6.15163807 L0,10.6229017 L0.299531981,10.6603432 L0.299531981,12.986209 L1.69160686,14.3775351 L4.47351014,14.3775351 L5.39157566,13.1970047 L5.39157566,15.575663 L4.7925117,15.575663 L4.7925117,16.773791 L10.513947,16.773791 C11.480312,16.773791 12.2808112,16.5117005 12.2808112,16.174727 C12.2808112,15.8718253 11.6341966,15.6295788 10.8018721,15.5835257 L13.4441186,12.2808112 L13.8615913,12.2808112 L15.425897,11.6420593 L19.4695788,11.1800312 C21.7535101,10.6726989 23.975663,10.3563183 23.9625585,8.38689548 C23.973791,6.41148206 21.7332917,6.09734789 19.4695788,5.59375975 Z M19.1700468,9.40530421 L14.9765991,9.88455538 L13.5088924,10.4836193 L12.5803432,10.4836193 L8.98595944,14.9765991 L7.18876755,14.9765991 L7.18876755,9.88455538 L5.69110764,9.88455538 L3.59438378,12.5803432 L2.43631825,12.5803432 L2.09672387,12.2407488 L2.09672387,10.1840874 L2.39625585,10.1840874 L2.39625585,9.5850234 L3.89391576,9.5850234 L3.89391576,9.28549142 L1.79719189,9.03088924 L1.79719189,7.74290172 L3.89391576,7.48829953 L3.89391576,7.18876755 L2.39625585,7.18876755 L2.39625585,6.58970359 L2.09672387,6.58970359 L2.09672387,4.53304212 L2.43631825,4.19344774 L3.59438378,4.19344774 L5.69110764,6.88923557 L7.18876755,6.88923557 L7.18876755,1.79719189 L8.98595944,1.79719189 L12.5803432,6.29017161 L13.5088924,6.29017161 L14.9765991,6.88923557 L19.1700468,7.36848674 C22.225273,8.04730109 22.1653666,8.21466459 22.1653666,8.38689548 C22.1653666,8.55912637 22.225273,8.72648986 19.1700468,9.40530421 Z" ></path>
    </g>
    <polyline id="pursuer-path" fill="none" stroke="red"
              stroke-opacity="0.2" stroke-width="3" [attr.points]="trajectories['Pursuer']"></polyline>
    <polyline id="evader-path" fill="none" stroke="blue"
              stroke-opacity="0.2" stroke-width="3" [attr.points]="trajectories['Evader']"></polyline>
  </g>
</svg>
